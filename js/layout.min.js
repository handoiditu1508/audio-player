let inputId="audioInput",listElements=[],playOrder=[],playOrderIndex=null,isShuffled=!1,autoPlayTimeoutId=null;function getInputAudios(){return document.getElementById(inputId).files}function getPlayer(){return document.getElementById("player")}function getList(){return document.getElementById("playList")}function getPreviousBtn(){return document.getElementById("previousBtn")}function getNextBtn(){return document.getElementById("nextBtn")}function getShuffleBtn(){return document.getElementById("shuffleBtn")}function getUnshuffleBtn(){return document.getElementById("unshuffleBtn")}function isAutoPlay(){return document.getElementById("autoPlay").checked}function getTimeBetweenSongs(){let e=parseFloat(document.getElementById("timeBetweenSongs").value);return isNaN(e)&&(e=0),e}function stopAutoPlayTimeout(){null!=autoPlayTimeoutId&&(clearTimeout(autoPlayTimeoutId),autoPlayTimeoutId=null)}function setFileName(e){document.getElementById("fileName").innerHTML=e,window.document.title=e}function play(n){var l=getInputAudios();if(FileReader&&l&&l.length>n){let e=new FileReader,t=getPlayer();e.onload=function(){t.src=e.result,t.play(),enableBtns()},e.readAsDataURL(l[n])}}function playNext(){playOrder[playOrderIndex].classList.remove("playing"),playOrder.length>playOrderIndex+1?playOrderIndex++:playOrderIndex=0,play(playOrder[playOrderIndex].getAttribute("index")),playOrder[playOrderIndex].classList.add("playing"),setFileName(playOrder[playOrderIndex].innerHTML)}function playPrevious(){playOrder[playOrderIndex].classList.remove("playing"),-1<playOrderIndex-1?playOrderIndex--:playOrderIndex=playOrder.length-1,play(playOrder[playOrderIndex].getAttribute("index")),playOrder[playOrderIndex].classList.add("playing"),setFileName(playOrder[playOrderIndex].innerHTML)}function shuffleList(){for(let e=playOrder.length-1;0<e;e--){var t=Math.floor(Math.random()*(e+1));[playOrder[e],playOrder[t]]=[playOrder[t],playOrder[e]],e==playOrderIndex?playOrderIndex=t:t==playOrderIndex&&(playOrderIndex=e)}[playOrder[playOrderIndex],playOrder[0]]=[playOrder[0],playOrder[playOrderIndex]],playOrderIndex=0,isShuffled=!0}function unshuffleList(){playOrderIndex=parseInt(playOrder[playOrderIndex].getAttribute("index")),playOrder=[...listElements],isShuffled=!1}function handleListItemClickEvent(e){disableBtns();var t=parseInt(e.getAttribute("index"));play(t),playOrder[playOrderIndex].classList.remove("playing"),e.classList.add("playing"),setFileName(listElements[t].innerHTML),isShuffled?(e=playOrder.indexOf(e))<playOrderIndex?[playOrder[e],playOrder[playOrderIndex]]=[playOrder[playOrderIndex],playOrder[e]]:[playOrder[e],playOrder[++playOrderIndex]]=[playOrder[playOrderIndex],playOrder[e]]:playOrderIndex=t}function disableBtns(){getNextBtn().disabled=!0,getPreviousBtn().disabled=!0,getShuffleBtn().disabled=!0,getUnshuffleBtn().disabled=!0;for(let e=0;e<listElements.length;e++)listElements[e].setAttribute("onmouseup",null)}function enableBtns(){getNextBtn().disabled=!1,getPreviousBtn().disabled=!1,getShuffleBtn().disabled=!1,getUnshuffleBtn().disabled=!1;for(let e=0;e<listElements.length;e++)listElements[e].setAttribute("onmouseup","handleListItemClickEvent(this)")}getPlayer().addEventListener("play",()=>{stopAutoPlayTimeout()}),getNextBtn().addEventListener("mouseup",()=>{disableBtns(),listElements.length&&playNext()}),getPreviousBtn().addEventListener("mouseup",()=>{disableBtns(),listElements.length&&playPrevious()}),getShuffleBtn().addEventListener("mouseup",e=>{disableBtns(),listElements.length&&(shuffleList(),e.target.innerHTML="Reshuffle"),enableBtns()}),getUnshuffleBtn().addEventListener("mouseup",()=>{disableBtns(),listElements.length&&(unshuffleList(),getShuffleBtn().innerHTML="Shuffle"),enableBtns()}),document.getElementById(inputId).addEventListener("change",e=>{disableBtns();var l=(e.target||window.event.srcElement).files;if(FileReader&&l&&l.length){{let e=new FileReader;e.onload=function(){getPlayer().src=e.result,enableBtns()},e.readAsDataURL(l[0])}getShuffleBtn().innerHTML="Shuffle";let e=getList();e.innerHTML="";let n=document.createElement("DIV");for(i=0;i<l.length;i++){let e=document.createElement("LI");e.classList.add("media-list-item"),e.setAttribute("index",i);let t=l[i].name;t=t.substring(0,t.lastIndexOf(".")),e.innerHTML=t,0==i&&(e.classList.add("playing"),setFileName(t)),e.setAttribute("onmouseup","handleListItemClickEvent(this)"),n.appendChild(e)}e.innerHTML=n.innerHTML,listElements=[...e.children],playOrder=[...listElements],playOrderIndex=0}else alert("Not supported")}),getPlayer().addEventListener("ended",function(e){isAutoPlay()&&playOrder.length>playOrderIndex+1&&(autoPlayTimeoutId=setTimeout(function(){disableBtns(),playOrder[playOrderIndex].classList.remove("playing"),play(playOrder[++playOrderIndex].getAttribute("index")),playOrder[playOrderIndex].classList.add("playing"),setFileName(playOrder[playOrderIndex].innerHTML)},1e3*getTimeBetweenSongs()))});