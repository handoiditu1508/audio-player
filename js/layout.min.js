let inputId="audioInput",listItemsId="media-list-item",listElements=[],playOrder=[],playOrderIndex=null,isShuffled=null;function getInputAudios(){let a=document.getElementById(inputId);return a.files}function getPlayer(){return document.getElementById("player")}function getList(){return document.getElementById("playList")}function getPreviousBtn(){return document.getElementById("previousBtn")}function getNextBtn(){return document.getElementById("nextBtn")}function getShuffleBtn(){return document.getElementById("shuffleBtn")}function getUnshuffleBtn(){return document.getElementById("unshuffleBtn")}function setFileName(a){document.getElementById("fileName").innerHTML=a,window.document.title=a}function play(a){let b=getInputAudios();if(FileReader&&b&&b.length>a){let c=new FileReader,d=getPlayer();c.onload=function(){d.src=c.result,d.play(),enableBtns()},c.readAsDataURL(b[a])}}function playNext(){playOrder[playOrderIndex].classList.remove("playing"),playOrder.length>playOrderIndex+1?playOrderIndex++:playOrderIndex=0,play(playOrder[playOrderIndex].getAttribute("index")),playOrder[playOrderIndex].classList.add("playing"),setFileName(playOrder[playOrderIndex].innerHTML)}function playPrevious(){playOrder[playOrderIndex].classList.remove("playing"),-1<playOrderIndex-1?playOrderIndex--:playOrderIndex=playOrder.length-1,play(playOrder[playOrderIndex].getAttribute("index")),playOrder[playOrderIndex].classList.add("playing"),setFileName(playOrder[playOrderIndex].innerHTML)}function shuffleList(){for(let a,b=playOrder.length-1;0<b;b--)a=Math.floor(Math.random()*(b+1)),[playOrder[b],playOrder[a]]=[playOrder[a],playOrder[b]],b==playOrderIndex?playOrderIndex=a:a==playOrderIndex&&(playOrderIndex=b);[playOrder[playOrderIndex],playOrder[0]]=[playOrder[0],playOrder[playOrderIndex]],playOrderIndex=0,isShuffled=!0}function unshuffleList(){playOrderIndex=parseInt(playOrder[playOrderIndex].getAttribute("index")),playOrder=[...listElements],isShuffled=!1}getNextBtn().addEventListener("mouseup",()=>{disableBtns(),listElements.length&&playNext()}),getPreviousBtn().addEventListener("mouseup",()=>{disableBtns(),listElements.length&&playPrevious()}),getShuffleBtn().addEventListener("mouseup",a=>{disableBtns(),listElements.length&&(shuffleList(),a.target.innerHTML="Reshuffle"),enableBtns()}),getUnshuffleBtn().addEventListener("mouseup",()=>{disableBtns(),listElements.length&&(unshuffleList(),getShuffleBtn().innerHTML="Shuffle"),enableBtns()});function handleListItemClickEvent(a){disableBtns();let b=parseInt(a.getAttribute("index"));if(play(b),playOrder[playOrderIndex].classList.remove("playing"),a.classList.add("playing"),setFileName(listElements[b].innerHTML),isShuffled){let b=playOrder.indexOf(a);b<playOrderIndex?[playOrder[b],playOrder[playOrderIndex]]=[playOrder[playOrderIndex],playOrder[b]]:[playOrder[b],playOrder[++playOrderIndex]]=[playOrder[playOrderIndex],playOrder[b]]}else playOrderIndex=b}document.getElementById("audioInput").addEventListener("change",a=>{let b=a.target||window.event.srcElement,c=b.files,d=0;if(FileReader&&c&&c.length){let a=new FileReader;a.onload=function(){getPlayer().src=a.result},a.readAsDataURL(c[d])}else return void alert("Not supported");let e=getList();e.innerHTML="";let f=document.createElement("DIV");for(i=0;i<c.length;i++){let a=document.createElement("LI");a.classList.add(listItemsId),a.setAttribute("index",i);let b=c[i].name;b=b.substring(0,b.lastIndexOf(".")),a.innerHTML=b,i==d&&(a.classList.add("playing"),setFileName(b)),a.setAttribute("onmouseup","handleListItemClickEvent(this)"),f.appendChild(a)}e.innerHTML=f.innerHTML,listElements=[...e.children],playOrder=[...listElements],playOrderIndex=d}),getPlayer().addEventListener("ended",function(){playOrder.length>playOrderIndex+1&&(playOrder[playOrderIndex].classList.remove("playing"),play(playOrder[++playOrderIndex].getAttribute("index")),playOrder[playOrderIndex].classList.add("playing"),setFileName(playOrder[playOrderIndex].innerHTML))});function disableBtns(){getNextBtn().disabled=!0,getPreviousBtn().disabled=!0,getShuffleBtn().disabled=!0,getUnshuffleBtn().disabled=!0;for(let a=0;a<listElements.length;a++)listElements[a].setAttribute("onmouseup",null)}function enableBtns(){getNextBtn().disabled=!1,getPreviousBtn().disabled=!1,getShuffleBtn().disabled=!1,getUnshuffleBtn().disabled=!1;for(let a=0;a<listElements.length;a++)listElements[a].setAttribute("onmouseup","handleListItemClickEvent(this)")}